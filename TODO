Enable sysctl based protection
Additionally we can tweak kernel and system variables in our server. Edit the file /etc/sysctl.conf, and set these two lines to 1 like this:

net.ipv4.conf.all.rp_filter = 1
net.ipv4.tcp_syncookies = 1

The first parameter enables protection against IP spoofing, and the second allows TCP SYN cookie protection.


# GOACCESS
sudo apt-get install goaccess
./nginx2goaccess.sh '$remote_addr - $remote_user [$time_local] "$request" $status $body_bytes_sent "$http_referer" "$http_user_agent" "$http_x_forwarded_for" $request_id rt=$request_time uct="$upstream_connect_time" uht="$upstream_header_time" urt="$upstream_response_time" $ssl_protocol $ssl_cipher'
goaccess -f /var/log/nginx/access.log --log-format=OUTPUT_ABOVE --date-format=OUTPUT_ABOVE --time-format=OUTPUT_ABOVE -o /var/www/goaccess/log_analysis.html